<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Splat simulation parameters • Splatter</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Splat simulation parameters">
<meta property="og:description" content="splatter">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-52309538-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-52309538-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Splatter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.11.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/splatter.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/splat_params.html">Splat simulation parameters</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Oshlack/splatter/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="splat_params_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Splat simulation parameters</h1>
            
            <h4 class="date">Last updated: 18 April 2019</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Oshlack/splatter/blob/master/vignettes/splat_params.Rmd"><code>vignettes/splat_params.Rmd</code></a></small>
      <div class="hidden name"><code>splat_params.Rmd</code></div>

    </div>

    
    
<p>This vignette describes the Splat simulation model and the parameters it uses in more detail.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"splatter"</span>)
<span class="co">#&gt; Loading required package: SingleCellExperiment</span>
<span class="co">#&gt; Loading required package: SummarizedExperiment</span>
<span class="co">#&gt; Loading required package: GenomicRanges</span>
<span class="co">#&gt; Loading required package: stats4</span>
<span class="co">#&gt; Loading required package: BiocGenerics</span>
<span class="co">#&gt; Loading required package: parallel</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'BiocGenerics'</span>
<span class="co">#&gt; The following objects are masked from 'package:parallel':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span>
<span class="co">#&gt;     clusterExport, clusterMap, parApply, parCapply, parLapply,</span>
<span class="co">#&gt;     parLapplyLB, parRapply, parSapply, parSapplyLB</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     IQR, mad, sd, var, xtabs</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     anyDuplicated, append, as.data.frame, basename, cbind, colnames,</span>
<span class="co">#&gt;     dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,</span>
<span class="co">#&gt;     grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,</span>
<span class="co">#&gt;     order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,</span>
<span class="co">#&gt;     rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,</span>
<span class="co">#&gt;     union, unique, unsplit, which, which.max, which.min</span>
<span class="co">#&gt; Loading required package: S4Vectors</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'S4Vectors'</span>
<span class="co">#&gt; The following object is masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     expand.grid</span>
<span class="co">#&gt; Loading required package: IRanges</span>
<span class="co">#&gt; Loading required package: GenomeInfoDb</span>
<span class="co">#&gt; Loading required package: Biobase</span>
<span class="co">#&gt; Welcome to Bioconductor</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Vignettes contain introductory material; view with</span>
<span class="co">#&gt;     'browseVignettes()'. To cite Bioconductor, see</span>
<span class="co">#&gt;     'citation("Biobase")', and for packages 'citation("pkgname")'.</span>
<span class="co">#&gt; Loading required package: DelayedArray</span>
<span class="co">#&gt; Loading required package: matrixStats</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'matrixStats'</span>
<span class="co">#&gt; The following objects are masked from 'package:Biobase':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     anyMissing, rowMedians</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'DelayedArray'</span>
<span class="co">#&gt; The following objects are masked from 'package:matrixStats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     colMaxs, colMins, colRanges, rowMaxs, rowMins, rowRanges</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     aperm, apply, rowsum</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"scater"</span>)
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ggplot2"</span>)</pre></body></html></div>
<div id="the-base-splat-model" class="section level1">
<h1 class="hasAnchor">
<a href="#the-base-splat-model" class="anchor"></a>The base Splat model</h1>
<p>This figure, taken from the Splatter publication, describes the core of the Splat simulation model.</p>
<div class="figure">
<img src="splat-model.png" alt=""><p class="caption">Splat simulation model</p>
</div>
<p>The Splat simulation uses a hierarchical probabilistic where different aspects of a dataset are generated from appropriate statistical distributions. The first stage generates a mean expression level for each gene. These are originally chosen from a Gamma distribution. For some genes that are selected to be outliers with high expression a factor is generated from a log-normal distribution. These factors are then multiplied by the median gene mean to create new means for those genes.</p>
<p>The next stage incorporates variation in the counts per cell. An expected library size (total counts) is chosen for each cell from a log-normal distribution. The library sizes are then used to scale the gene means for each cell, resulting in a range a counts per cell in the simulated dataset. The gene means are then further adjusted to enforce a relationship between the mean expression level and the variability.</p>
<p>The final cell by gene matrix of gene means is then used to generate a count matrix using a Poisson distribution. The result is a synthetic dataset consisting of counts from a Gamma-Poisson (or negative-binomial) distribution. An additional optional step can be used to replicate a “dropout” effect. A probability of dropout is generated using a logistic function based on the underlying mean expression level. A Bernoulli distribution is then used to create a dropout matrix which sets some of the generated counts to zero.</p>
<p>The model described here will generate a single population of cells but the Splat simulation has been designed to be as flexible as possible and can create scenarios including multiple groups of cells (cell types), continuous paths between cell types and multiple experimental batches. The parameters used to create these types of simulations and how they interact with the model are described below.</p>
</div>
<div id="splat-simulation-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#splat-simulation-parameters" class="anchor"></a>Splat simulation parameters</h1>
<p>Within Splatter the parameters for the Splat simulation model are held in the <code>SplatParams</code> object. Let’s create one of these objects and see what it looks like.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">params</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/newParams.html">newSplatParams</a></span>()
<span class="no">params</span>
<span class="co">#&gt; A Params object of class SplatParams </span>
<span class="co">#&gt; Parameters can be (estimable) or [not estimable], 'Default' or  'NOT DEFAULT' </span>
<span class="co">#&gt; Secondary parameters are usually set during simulation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Global: </span>
<span class="co">#&gt; (Genes)  (Cells)   [Seed] </span>
<span class="co">#&gt;   10000      100   678932 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 28 additional parameters </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Batches: </span>
<span class="co">#&gt;     [Batches]  [Batch Cells]     [Location]        [Scale] </span>
<span class="co">#&gt;             1            100            0.1            0.1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mean: </span>
<span class="co">#&gt;  (Rate)  (Shape) </span>
<span class="co">#&gt;     0.3      0.6 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Library size: </span>
<span class="co">#&gt; (Location)     (Scale)      (Norm) </span>
<span class="co">#&gt;         11         0.2       FALSE </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Exprs outliers: </span>
<span class="co">#&gt; (Probability)     (Location)        (Scale) </span>
<span class="co">#&gt;          0.05              4            0.5 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Groups: </span>
<span class="co">#&gt;      [Groups]  [Group Probs] </span>
<span class="co">#&gt;             1              1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Diff expr: </span>
<span class="co">#&gt; [Probability]    [Down Prob]     [Location]        [Scale] </span>
<span class="co">#&gt;           0.1            0.5            0.1            0.4 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; BCV: </span>
<span class="co">#&gt; (Common Disp)          (DoF) </span>
<span class="co">#&gt;           0.1             60 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Dropout: </span>
<span class="co">#&gt;     [Type]  (Midpoint)     (Shape) </span>
<span class="co">#&gt;       none           0          -1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Paths: </span>
<span class="co">#&gt;         [From]         [Steps]          [Skew]    [Non-linear]  [Sigma Factor] </span>
<span class="co">#&gt;              0             100             0.5             0.1             0.8</span></pre></body></html></div>
<p>Like all the parameter objects in Splatter printing this object displays all the parameters required for this simulation. As we haven’t set any of the parameters the default values are shown but if we were to change any of them they would be highlighted. We can also see which parameters can be estimated by the Splat estimation procedure and which can’t. The default values have been chosen to be fairly realistic but it is recommended that estimation is used to get a simulation that is more like the data you are interested in. Parameters can be modified by setting them in the <code>SplatParams</code> object or by providing them directly to the simulation function.</p>
<p>The rest of this section provides details of all this parameters and explains how they can be used with examples.</p>
<div id="global-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#global-parameters" class="anchor"></a>Global parameters</h2>
<p>These parameters are used in every simulation model and control global features of the dataset produced.</p>
<div id="ngenes---number-of-genes" class="section level3">
<h3 class="hasAnchor">
<a href="#ngenes---number-of-genes" class="anchor"></a><code>nGenes</code> - Number of genes</h3>
<p>The number of genes to simulate.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># Set the number of genes to 1000</span>
<span class="no">params</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/setParam.html">setParam</a></span>(<span class="no">params</span>, <span class="st">"nGenes"</span>, <span class="fl">1000</span>)

<span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulate</a></span>(<span class="no">params</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">sim</span>)
<span class="co">#&gt; [1] 1000  100</span></pre></body></html></div>
</div>
<div id="ncells---number-of-cells" class="section level3">
<h3 class="hasAnchor">
<a href="#ncells---number-of-cells" class="anchor"></a><code>nCells</code> - Number of cells</h3>
<p>The number of genes to simulate. In the Splat simulation this cannot be set directly but must be controlled using the <code>batchCells</code> parameter.</p>
</div>
<div id="seed---random-seed" class="section level3">
<h3 class="hasAnchor">
<a href="#seed---random-seed" class="anchor"></a><code>seed</code> - Random seed</h3>
<p>Seed to use for generating random numbers including selecting values from distributions. By changing this value multiple simulated datasets with the same parameters can be produced. Simulations produced using the same set of parameters and random seed should be identical but there may be differences between operating systems, software versions etc.</p>
</div>
</div>
<div id="batch-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#batch-parameters" class="anchor"></a>Batch parameters</h2>
<p>These parameters control experimental batches in the simulated dataset. The overall effect of how batch effects are included in the model is similar to technical replicates (i.e. the same biological sample sequenced multiple times). This means that the underlying structure is consistent between batches but a global technical signature is added may separate them.</p>
<div id="nbatches---number-of-batches" class="section level3">
<h3 class="hasAnchor">
<a href="#nbatches---number-of-batches" class="anchor"></a><code>nBatches</code> - Number of batches</h3>
<p>The number of batches in the simulation. This cannot be set directly but is controlled by setting <code>batchCells</code>.</p>
</div>
<div id="batchcells---cells-per-batch" class="section level3">
<h3 class="hasAnchor">
<a href="#batchcells---cells-per-batch" class="anchor"></a><code>batchCells</code> - Cells per batch</h3>
<p>A vector specifying the number of cells in each batch. The number of batches (<code>nBatches</code>) is equal to the length of the vector and the number of cells (<code>nCells</code>) is equal to the sum.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># Simulation with two batches of 100 cells</span>
<span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulate</a></span>(<span class="no">params</span>, <span class="kw">batchCells</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">100</span>, <span class="fl">100</span>), <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="co"># PCA plot using scater</span>
<span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim</span>)
<span class="no">sim</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Batch"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/batches-1.png" width="700"></p>
</div>
<div id="batch-facloc---batch-factor-location-and-batch-facscale---batch-factor-scale" class="section level3">
<h3 class="hasAnchor">
<a href="#batch-facloc---batch-factor-location-and-batch-facscale---batch-factor-scale" class="anchor"></a><code>batch.facLoc</code> - Batch factor location and <code>batch.facScale</code> - Batch factor scale</h3>
<p>Batches are specified by generating a small scaling factor for each gene in each batch from a log-normal distribution. These factors are then applied to the underlying gene means in each batch. Modifying these parameters affects how different the batches are from each other by generating bigger or smaller factors.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># Simulation with small batch effects</span>
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulate</a></span>(<span class="no">params</span>, <span class="kw">batchCells</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">100</span>, <span class="fl">100</span>),
                      <span class="kw">batch.facLoc</span> <span class="kw">=</span> <span class="fl">0.001</span>, <span class="kw">batch.facScale</span> <span class="kw">=</span> <span class="fl">0.001</span>,
                      <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim1</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim1</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Batch"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Small batch effects"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/batch-factors-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">
<span class="co"># Simulation with big batch effects</span>
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulate</a></span>(<span class="no">params</span>, <span class="kw">batchCells</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">100</span>, <span class="fl">100</span>),
                      <span class="kw">batch.facLoc</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">batch.facScale</span> <span class="kw">=</span> <span class="fl">0.5</span>,
                      <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim2</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim2</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim2</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Batch"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Big batch effects"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/batch-factors-2.png" width="700"></p>
</div>
</div>
<div id="mean-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#mean-parameters" class="anchor"></a>Mean parameters</h2>
<p>These parameters control the distribution that is used to generate the underlying original gene means.</p>
<div id="mean-shape---mean-shape-and-mean-rate---mean-rate" class="section level3">
<h3 class="hasAnchor">
<a href="#mean-shape---mean-shape-and-mean-rate---mean-rate" class="anchor"></a><code>mean.shape</code> - Mean shape and <code>mean.rate</code> - Mean rate</h3>
<p>These parameters control the Gamma distribution that gene means are drawn from. The relationship between shape and rate can be complex and it is often better to use values estimated from a real dataset than to try and manually set them. Although these parameters control the base gene means the means in the final simulation will depend upon other parts of the model, particularly the simulated total counts per cell (library sizes).</p>
</div>
</div>
<div id="library-size-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#library-size-parameters" class="anchor"></a>Library size parameters</h2>
<p>These parameters control the expected number of counts for each cell. Note that because of sampling the actual counts per cell in the final simulation may be different. Turning on the dropout effect will also effect this. We use the term “library size” here for consistency but expected total counts would be more appropriate.</p>
<div id="lib-loc---library-size-location-and-lib-scale---library-size-scale" class="section level3">
<h3 class="hasAnchor">
<a href="#lib-loc---library-size-location-and-lib-scale---library-size-scale" class="anchor"></a><code>lib.loc</code> - Library size location and <code>lib.scale</code> - Library size scale</h3>
<p>These parameters control the shape of the distribution that is used to generate library sizes for each cell. Increasing <code>lib.loc</code> will lead to more counts per cell and increasing <code>lib.scale</code> will result in more variability in the counts per cell.</p>
</div>
<div id="lib-norm---library-size-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#lib-norm---library-size-distribution" class="anchor"></a><code>lib.norm</code> - Library size distribution</h3>
<p>The default (and recommended) distribution used for library sizes in the Splat simulation is a log-normal. However, in rare cases a normal distribution might be more appropriate. Setting <code>lib.norm</code> to <code>TRUE</code> will use a normal distribution instead of a log-normal.</p>
</div>
</div>
<div id="expression-outlier-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#expression-outlier-parameters" class="anchor"></a>Expression outlier parameters</h2>
<p>When developing the Splat simulation we found that while the Gamma distribution was generally a good match for gene means for some datasets it did not properly capture highly expressed genes. For this reason we added expression outliers to the Splat model.</p>
<div id="out-prob---expression-outlier-probability" class="section level3">
<h3 class="hasAnchor">
<a href="#out-prob---expression-outlier-probability" class="anchor"></a><code>out.prob</code> - Expression outlier probability</h3>
<p>This parameter controls the probability that genes will be selected to be expression outliers. Higher values will results in more outlier genes.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># Few outliers</span>
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulate</a></span>(<span class="kw">out.prob</span> <span class="kw">=</span> <span class="fl">0.001</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="fu">rowData</span>(<span class="no">sim1</span>)),
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">GeneMean</span>), <span class="kw">fill</span> <span class="kw">=</span> <span class="no">OutlierFactor</span> <span class="kw">!=</span> <span class="fl">1</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw">bins</span> <span class="kw">=</span> <span class="fl">100</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Few outliers"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/outlier-prob-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><html><body><pre class="r">
<span class="co"># Lots of outliers</span>
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulate</a></span>(<span class="kw">out.prob</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="fu">rowData</span>(<span class="no">sim2</span>)),
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">GeneMean</span>), <span class="kw">fill</span> <span class="kw">=</span> <span class="no">OutlierFactor</span> <span class="kw">!=</span> <span class="fl">1</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw">bins</span> <span class="kw">=</span> <span class="fl">100</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Lots of outliers"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/outlier-prob-2.png" width="700"></p>
</div>
<div id="out-facloc---expression-outlier-factor-location-and-out-facscale---expression-outlier-factor-scale" class="section level3">
<h3 class="hasAnchor">
<a href="#out-facloc---expression-outlier-factor-location-and-out-facscale---expression-outlier-factor-scale" class="anchor"></a><code>out.facLoc</code> - Expression outlier factor location and <code>out.facScale</code> - Expression outlier factor scale</h3>
<p>The expression outlier factors are drawn from a log-normal distribution controlled by these parameters. The generated factors are applied to the median mean expression rather than the existing mean for the selected genes. This is to be consistent with the estimation procedure for these factors and to make sure that the final means are outliers. For example to avoid the situation where a factor is applied to a lowly expressed gene, making it just moderately expressed rather than an expression outlier.</p>
</div>
<div id="group-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#group-parameters" class="anchor"></a>Group parameters</h3>
<p>Up until this stage of the simulation only a single population of cells is considered but we often want to simulate datasets with multiple kinds of cells. We do this by assigning cells to groups.</p>
</div>
<div id="ngroups---number-of-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#ngroups---number-of-groups" class="anchor"></a><code>nGroups</code> - Number of groups</h3>
<p>The number of groups to simulate. This parameter cannot be set directly and is controlled using <code>group.prob</code>.</p>
</div>
<div id="group-prob---group-probabilities" class="section level3">
<h3 class="hasAnchor">
<a href="#group-prob---group-probabilities" class="anchor"></a><code>group.prob</code> - Group probabilities</h3>
<p>A vector giving the probability that cells will be assigned to groups. The length of the vector gives the number of groups (<code>nGroups</code>) and the probabilities must sum to 1. Adjusting the number and relative values of the probabilities changes the number and relative sizes of the groups. To simulate groups we also need to use the <code>splatSimulateGroups</code> function or set <code>method = "groups"</code>.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">params.groups</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/newParams.html">newSplatParams</a></span>(<span class="kw">batchCells</span> <span class="kw">=</span> <span class="fl">500</span>, <span class="kw">nGenes</span> <span class="kw">=</span> <span class="fl">1000</span>)

<span class="co"># One small group, one big group</span>
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulateGroups</a></span>(<span class="no">params.groups</span>, <span class="kw">group.prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.9</span>, <span class="fl">0.1</span>),
                            <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim1</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim1</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Group"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"One small group, one big group"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/groups-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><html><body><pre class="r">
<span class="co"># Five groups</span>
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulateGroups</a></span>(<span class="no">params.groups</span>,
                            <span class="kw">group.prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>),
                            <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim2</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim2</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim2</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Group"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Five groups"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/groups-2.png" width="700"></p>
<p><strong>Note:</strong> Once there are more than three or four groups it becomes difficult to properly view them in PCA space. We use PCA here for simplicity but generally a non-linear dimensionality reduction such as t-SNE or UMAP is a more useful way to visualise the groups.</p>
</div>
<div id="differential-expression-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#differential-expression-parameters" class="anchor"></a>Differential expression parameters</h3>
<p>Different groups are created by modifying the base expression levels of selected genes. The process for doing this is to simulate differential expression (DE) between each group and a fictional base cell. Altering the differential expression parameters controls how similar groups are to each other.</p>
</div>
<div id="de-prob---de-probability" class="section level3">
<h3 class="hasAnchor">
<a href="#de-prob---de-probability" class="anchor"></a><code>de.prob</code> - DE probability</h3>
<p>This parameter controls the probability that a gene will be selected to be differentially expressed.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co"># Few DE genes</span>
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulateGroups</a></span>(<span class="no">params.groups</span>, <span class="kw">group.prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),
                            <span class="kw">de.prob</span> <span class="kw">=</span> <span class="fl">0.01</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim1</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim1</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Group"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Few DE genes"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/de-prob-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">
<span class="co"># Lots of DE genes</span>
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulateGroups</a></span>(<span class="no">params.groups</span>, <span class="kw">group.prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),
                            <span class="kw">de.prob</span> <span class="kw">=</span> <span class="fl">0.3</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim2</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim2</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim2</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Group"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Lots of DE genes"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/de-prob-2.png" width="700"></p>
</div>
<div id="de-downprob---down-regulation-probability" class="section level3">
<h3 class="hasAnchor">
<a href="#de-downprob---down-regulation-probability" class="anchor"></a><code>de.downProb</code> - Down-regulation probability</h3>
<p>A selected DE gene can be either down-regulated (has a factor less than one) or up-regulated (has a factor greater than one). This parameter controls the probability that a selected gene will be down-regulated.</p>
</div>
<div id="de-facloc---de-factor-location-and-de-facscale---de-factor-scale" class="section level3">
<h3 class="hasAnchor">
<a href="#de-facloc---de-factor-location-and-de-facscale---de-factor-scale" class="anchor"></a><code>de.facLoc</code> - DE factor location and <code>de.facScale</code> - DE factor scale</h3>
<p>Differential expression factors are produced from a log-normal distribution in a similar way to batch effect factors and expression outlier factors. Changing these parameters can result in more or less extreme differences between groups.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co"># Small DE factors</span>
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulateGroups</a></span>(<span class="no">params.groups</span>, <span class="kw">group.prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),
                            <span class="kw">de.facLoc</span> <span class="kw">=</span> <span class="fl">0.01</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim1</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim1</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Group"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Small DE factors"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/de-factors-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><html><body><pre class="r">
<span class="co"># Big DE factors</span>
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulateGroups</a></span>(<span class="no">params.groups</span>, <span class="kw">group.prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),
                            <span class="kw">de.facLoc</span> <span class="kw">=</span> <span class="fl">0.3</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim2</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim2</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim2</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Group"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Big DE factors"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/de-factors-2.png" width="700"></p>
<p>Just looking at the PCA plots this effect seems similar to adjusting <code>de.prob</code> but the effect is achieved in a different way. A higher <code>de.prob</code> means that more genes are differentially expressed but changing the DE factors changes the level of DE for the same number of genes.</p>
</div>
<div id="complex-differential-expression" class="section level3">
<h3 class="hasAnchor">
<a href="#complex-differential-expression" class="anchor"></a>Complex differential expression</h3>
<p>Each of the differential expression parameters can be specified for each group by providing a vector of values. These vectors must be the same length as <code>group.prob</code>. Specifying parameters as vectors allows more complex simulations where groups are more or less different to each other rather than being equally distinct. Here are some examples of different DE scenarios.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="co"># Different DE probs</span>
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulateGroups</a></span>(<span class="no">params.groups</span>,
                            <span class="kw">group.prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>),
                            <span class="kw">de.prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>),
                            <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim1</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim1</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Group"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Different DE probabilities"</span>,
         <span class="kw">caption</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Groups 1 and 2 have very few DE genes,"</span>,
                         <span class="st">"Groups 3 and 4 have the default number,"</span>,
                         <span class="st">"Group 5 has many DE genes"</span>))</pre></body></html></div>
<p><img src="splat_params_files/figure-html/complex-de-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><html><body><pre class="r">

<span class="co"># Different DE factors</span>
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulateGroups</a></span>(<span class="no">params.groups</span>,
                            <span class="kw">group.prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>),
                            <span class="kw">de.facLoc</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>),
                            <span class="kw">de.facScale</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span>),
                            <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim2</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim2</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim2</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Group"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Different DE factors"</span>,
         <span class="kw">caption</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Group 1 has factors with small location (value),"</span>,
                         <span class="st">"and scale (variability),"</span>,
                         <span class="st">"Group 2 has small location and greater scale.\n"</span>,
                         <span class="st">"Groups 3 and 4 have greater location with small,"</span>,
                         <span class="st">"and large scales"</span>,
                         <span class="st">"Group 5 has bigger factors with moderate"</span>,
                         <span class="st">"variability"</span>))</pre></body></html></div>
<p><img src="splat_params_files/figure-html/complex-de-2.png" width="700"></p>
<div class="sourceCode" id="cb17"><html><body><pre class="r">
<span class="co"># Combination of everything</span>
<span class="no">sim3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulateGroups</a></span>(<span class="no">params.groups</span>,
                            <span class="kw">group.prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.35</span>),
                            <span class="kw">de.prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>),
                            <span class="kw">de.downProb</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span>),
                            <span class="kw">de.facLoc</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.6</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.2</span>),
                            <span class="kw">de.facScale</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span>),
                            <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim3</span>)
<span class="no">sim3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim3</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim3</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Group"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Different DE factors"</span>,
         <span class="kw">caption</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(
             <span class="st">"Group 1 is small with many very up-regulated DE genes,"</span>,
             <span class="st">"Group 2 has the default DE parameters,\n"</span>,
             <span class="st">"Group 3 has many down-regulated DE genes,"</span>,
             <span class="st">"Group 4 has very few DE genes,"</span>,
             <span class="st">"Group 5 is large with moderate DE factors"</span>)
         )</pre></body></html></div>
<p><img src="splat_params_files/figure-html/complex-de-3.png" width="700"></p>
</div>
</div>
<div id="biological-coefficient-of-variation-bcv-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#biological-coefficient-of-variation-bcv-parameters" class="anchor"></a>Biological Coefficient of Variation (BCV) parameters</h2>
<p>The BCV parameters control the variability of the genes in the simulated dataset.</p>
<div id="bcv-common---common-bcv" class="section level3">
<h3 class="hasAnchor">
<a href="#bcv-common---common-bcv" class="anchor"></a><code>bcv.common</code> - Common BCV</h3>
<p>The <code>bcv.common</code> parameter controls the underlying common variability across all genes in the dataset.</p>
</div>
<div id="bcv-df---bcv-degrees-of-freedom" class="section level3">
<h3 class="hasAnchor">
<a href="#bcv-df---bcv-degrees-of-freedom" class="anchor"></a><code>bcv.df</code> - BCV Degrees of Freedom</h3>
<p>This parameter sets the degrees of freedom used in the BCV inverse chi-squared distribution. Changing this changes the effect of mean expression on the variability of a gene.</p>
</div>
</div>
<div id="dropout-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#dropout-parameters" class="anchor"></a>Dropout parameters</h2>
<p>These parameters control whether additional dropout is added to increase the number of zeros in the simulated dataset and if it is how that is applied.</p>
<div id="dropout-type---dropout-type" class="section level3">
<h3 class="hasAnchor">
<a href="#dropout-type---dropout-type" class="anchor"></a><code>dropout.type</code> - Dropout type</h3>
<p>This parameter determines the kind of dropout effect to simulate. Setting it to <code>"none"</code> means no dropout, “<code>experiment</code>” is global dropout using the same set of parameters for every cell, <code>"batch"</code> uses the same parameters for every cell in the same batch, <code>"group"</code> uses the same parameters for every cell in the same group and <code>"cell"</code> uses a different set of parameters for every cell.</p>
</div>
<div id="dropout-mid---dropout-mid-point-and-dropout-shape---dropout-shape" class="section level3">
<h3 class="hasAnchor">
<a href="#dropout-mid---dropout-mid-point-and-dropout-shape---dropout-shape" class="anchor"></a><code>dropout.mid</code> - Dropout mid point and <code>dropout.shape</code> - Dropout shape</h3>
<p>The probability that a particular count in a particular cell is set to zero is related to the mean expression of that gene in that cell. This relationship is represented using a logistic function with these parameters. The <code>dropout.mid</code> parameter control the point at which the probability is equal to 0.5 and the <code>dropout.shape</code> controls how it changes with increasing expression. These parameters must be vectors of the appropriate length depending on the selected dropout type.</p>
</div>
</div>
<div id="path-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#path-parameters" class="anchor"></a>Path parameters</h2>
<p>For many uses simulating groups is sufficient but in some cases it is more appropriate to simulate continuous changes between cell types. The number of paths and the probability of assigning cells to them is still controlled by the <code>group.prob</code> parameter and the amount of change along a path is controlled by the DE parameters but other aspects of the <code>splatSimulatePaths</code> model are controlled by these parameters.</p>
<div id="path-from---path-origin" class="section level3">
<h3 class="hasAnchor">
<a href="#path-from---path-origin" class="anchor"></a><code>path.from</code> - Path origin</h3>
<p>This parameter controls the order of differentiation paths. It is a vector the same length as <code>group.prob</code> giving the starting position of each path. For example a <code>path.from</code> of <code><a href="https://rdrr.io/r/base/c.html">c(0, 1, 1, 3)</a></code> would indicate the Path 1 starts at the origin (0), Path 2 starts at the end of Path 1, Path 3 also starts at the end of Path 1 (a branch point) and Path 4 starts at the end of Path 3.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="co"># Linear paths</span>
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulatePaths</a></span>(<span class="no">params.groups</span>,
                           <span class="kw">group.prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>),
                           <span class="kw">de.prob</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">de.facLoc</span> <span class="kw">=</span> <span class="fl">0.2</span>,
                           <span class="kw">path.from</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>),
                           <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim1</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim1</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Group"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Linear paths"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/paths-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><html><body><pre class="r">
<span class="co"># Branching path</span>
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulatePaths</a></span>(<span class="no">params.groups</span>,
                           <span class="kw">group.prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>),
                           <span class="kw">de.prob</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">de.facLoc</span> <span class="kw">=</span> <span class="fl">0.2</span>,
                           <span class="kw">path.from</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>),
                           <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim2</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim2</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim2</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Group"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Branching path"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/paths-2.png" width="700"></p>
</div>
<div id="path-nsteps---number-of-steps" class="section level3">
<h3 class="hasAnchor">
<a href="#path-nsteps---number-of-steps" class="anchor"></a><code>path.nSteps</code> - Number of steps</h3>
<p>A path is created by using the same differential expression procedure as used for groups to generate an end point. Interpolation is then used to create a series of steps between the start and end points. This parameter controls the number of steps along a path and therefore how discrete or smooth it is.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="co"># Few steps</span>
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulatePaths</a></span>(<span class="no">params.groups</span>, <span class="kw">path.nSteps</span> <span class="kw">=</span> <span class="fl">3</span>,
                           <span class="kw">de.prob</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">de.facLoc</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim1</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim1</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Step"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Few steps"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/paths-steps-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><html><body><pre class="r">
<span class="co"># Lots of steps</span>
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulatePaths</a></span>(<span class="no">params.groups</span>, <span class="kw">path.nSteps</span> <span class="kw">=</span> <span class="fl">1000</span>,
                           <span class="kw">de.prob</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">de.facLoc</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim2</span>)
<span class="no">sim2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim2</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim2</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Step"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Lots of steps"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/paths-steps-2.png" width="700"></p>
</div>
<div id="path-skew---path-skew" class="section level3">
<h3 class="hasAnchor">
<a href="#path-skew---path-skew" class="anchor"></a><code>path.skew</code> - Path skew</h3>
<p>By default cells are evenly distributed along a path but it sometimes be useful to introduce a skew in the distribution, For example you may want to simulate a scenario with few stem-like cells and many differentiated cells. Setting <code>path.skew</code> to 0 will mean that all cells come from the end point while higher values up to 1 will skew them towards the start point.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="co"># Skew towards the end</span>
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/splatSimulate.html">splatSimulatePaths</a></span>(<span class="no">params.groups</span>, <span class="kw">path.skew</span> <span class="kw">=</span> <span class="fl">0.1</span>,
                           <span class="kw">de.prob</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">de.facLoc</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sim1</span>)
<span class="no">sim1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span>(<span class="no">sim1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span>(<span class="no">sim1</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"Step"</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Skewed towards the end"</span>)</pre></body></html></div>
<p><img src="splat_params_files/figure-html/paths-skew-1.png" width="700"></p>
</div>
<div id="path-nonlinearprob---non-linear-probability" class="section level3">
<h3 class="hasAnchor">
<a href="#path-nonlinearprob---non-linear-probability" class="anchor"></a><code>path.nonlinearProb</code> - Non-linear probability</h3>
<p>Most genes are interpolated in a linear way along a path but in reality this may not always be the case. For example it is easy to imagine a gene that is lowly-expressed at the start of a process, highly-expressed in the middle and lowly-expressed again at the end. The <code>path.nonlinearProb</code> parameter controls the probability that a gene will change in a non-linear way along a path.</p>
</div>
<div id="path-sigmafac---path-skew" class="section level3">
<h3 class="hasAnchor">
<a href="#path-sigmafac---path-skew" class="anchor"></a><code>path.sigmaFac</code> - Path skew</h3>
<p>Non-linear changes along a path are achieved by building a Brownian bridge between the two end points. A Brownian bridge is Brownian motion controlled in such a way that the end points are fixed. The <code>path.sigmaFac</code> parameter controls how extreme each step in the Brownian motion is and therefore how much the interpolation differs from a linear path.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Luke Zappia, Belinda Phipson, Alicia Oshlack.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
